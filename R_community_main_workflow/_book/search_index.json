[["01-R_community_main_workflow.html", "R community analysis Chapter 1 Introduction", " R community analysis Matthew R. Gemmell 2022-12-21 Chapter 1 Introduction A lot of different analysis and visualisations can be carried out with community data. This includes taxonomy and functional abundance tables from 16S rRNA and Shotgun metagenomics analysis. This workshop will teach you how to use R with the phyloseq R object; a specialised object containing an abundance, taxonomy, and metadata table. The workshop will use a 16S dataset that has been pre-analysed with QIIME2 to create the ASV table, taxonomy table, and phylogenetic tree. Supplementary materials will show how to import Bracken shotgun metagenomic abundance data and generic abundance data frames into a phyloseq object. Sessions will start with a brief presentation followed by self-paced computer practicals guided by an online interactive book. The book will contain theory and practice code. This will be reinforced with multiple choice questions that will recap concepts and aid in interpretation of results. At the end of the course learners will be able to: Import QIIME2 artifacts into a phyloseq object. Summarise the abundance and taxonomy contents of a phyloseq object Preprocess the abundance and taxonomy tables. This will include transforming sample counts, and subsetting samples &amp; taxonomies. Understand the grammar of graphics (ggplot2) used by phyloseq and related packages. Carry out alpha &amp; beta diversity, and biomarker detection with the phyloseq object. Produce and customise publication quality plots. Run statistical analysis and incorporate these values into the plots. Convert static plots into interactive html plots with plotly within R. This work is licensed under a Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License. "],["02-Dataset_and_workflow.html", "Chapter 2 Dataset &amp; workflow 2.1 Dataset 2.2 Workflow 2.3 Scripts and working directory", " Chapter 2 Dataset &amp; workflow 2.1 Dataset 2.2 Workflow 2.3 Scripts and working directory Different people like to sort out their workflows and directories/folders in different ways. Some people like to use RStudio projects. Personally, I like to create one directory for an analysis project. In this directory I: Have a directory with my input. I save my scripts. I save my output, possibly to sub-directories. This is the method that will be used in these materials. To start, create a directory on your computer for the analysis of the French freshwater data (can be done inside our outside of RStudio. For example: \"~/R/R_community_course/freshwater_data_analysis/\" Next we need our data. Download and save the following link into your analysis directory: freshwater_water_france.zip It is a zipped directory, therefore unzip the directory/folder. Windows unzipping Open File Explorer and find the zipped folder. To unzip the entire folder, right-click to select Extract All, and then click \"Extract\". Mac unzipping Double-click the .zip file. Finally, set your working directory in RStudio to your analysis directory. "],["03-R_packages.html", "Chapter 3 R Packages 3.1 R packages/libraries 3.2 The grammar of graphics 3.3 phyloseq", " Chapter 3 R Packages During this workshop we will use various R packages with their own intricacies. Before going into analysis we'll introduce you to some of these important concepts. 3.1 R packages/libraries R packages/libraries contain additional functions, data and code for analysing, manipulating and plotting different types of data. Many common packages will be installed as default when you install R. Other more specialised packages, such as the ggplot2 package, must be installed by the user. Packages found on The Comprehensive R Archive Network (CRAN) which is Râ€™s central software repository can be installed easily using the following command. install.packages(&quot;package_name&quot;) Every time you reload R you will need to load the packages you need if they are not one of the ones installed by default. To do this type: library(&quot;package_name&quot;) I generally have a list of library() functions at the top of my R scripts (.R files) for all the packages I use in the script. Throughout this course you will get a lot of practice installing and loading various packages. R package or R Library? R packages are a collection of R functions, data, and compiled code. You can install these into a directory on your computer. An R library is a directory containing a R package. Because of this, the terms R package and R library may be used synonymously. We will use the term package in this workshop. As we will be using a lot of packages we shall use a double colons to specify which package each function belongs to, unless the function is from base R. For example if we use the function summarize_phyloseq() from the package microbiome we would type the function like below: Note: Do not run the below command. microbiome::summarize_phyloseq() This convention has 2 benefits: We can easily tell which R package each function comes from. This is useful for your future coding where you may copy some, but not all, commands from one script to another. You will therefore know which packages you will need to load. If you need some more documentation about a function you will know what package to look up. Writing your methods will be a lot easier. Different packages may have functions with the same name. Specifying the package will ensure you are using the correct function. 3.2 The grammar of graphics During this course we will be using the grammar of graphics coding approach. This approach is implemented by the R package ggplot2 to create visualisations such as bar charts, box plots, ordination plots etc. In turn ggplot2 is used by a host of other packages, some of which we will be using. Although ggplot2 is R code its structure is very different and it takes effort to learn. Thankfully, ggplot2 is very powerful and flexible, and it produces very professional and clean plots. We will use the iris dataset (inbuilt into R) to show an example of ggplot2 code and its visualisation output is: Note: If you would like to see the contents of the iris dataset you can run the command View(iris) in your R instance. #Load library library(ggplot2) #Create new ggplot2 object using iris dataset ggplot2::ggplot(iris, aes(x=Sepal.Length, y=Sepal.Width, colour=Species)) + #Make the object a scatter plot ggplot2::geom_point() + ggplot2::ggtitle(&quot;Iris Sepal length vs width&quot;) + #Set x and y axis label names ggplot2::labs(x = &quot;Sepal length&quot;, y = &quot;Sepal width&quot;) We will not learn ggplot2 specifically during this course. However, the structure of creating an object will be used. In the above case the initial object was built with ggplot. Subsequently additions and edits were carried out with + and various other functions. An important concept of the grammar of graphics is aesthetics. Aesthetics are the parts of a graphic/plot. In the above command we set the aesthetics with the function aes() within the ggplot() function. The X aesthetic (i.e. what values are assigned to the x axis) was set as the Sepal length values from the column Sepal.Length of the dataframe iris. In turn the Y axis values are set to the Sepal width and the colouring of the points are set to the Species. That was a quick introduction to the grammar of graphics. We will be using this to create visualisations with a phyloseq object using various R packages specifically designed for community abundance data within phyloseq objects. For more resources on ggplot2 please see the appendix of this book. 3.3 phyloseq In this book we will be working with phyloseq objects to preprocess our dataset, create visualisations, and carry out statistical analyses. This is a very popular object type for community abundance datasets as it contains the abundance table, metadata, and taxonomy table in one object, optionally containing the phylogenetic tree and reference sequences if wanted/required. "],["04-Import.html", "Chapter 4 Import 4.1 Script 4.2 qiime2R 4.3 Save the phyloseq object 4.4 Recap", " Chapter 4 Import Before carrying out any analysis we first need to import our QIIME2 artifacts into a phyloseq object. Thankfully there is an R package called qiime2R 4.1 Script Prior to any coding, open and save a new script called \"01-Import.R\". We will be creating a new script for each chapter and numbering them so we can easily see the order of scripts. 4.2 qiime2R qiime2R has many different commands. However the best way to import your QIIME2 artifacts is with the qza_to_phyloseq() function. In your \"01-Import.R\" script, add the following and run the commands. #Set you working directory #This is useful to have at the top of your scripts #Esure you set it as your analysis directory setwd(&quot;~/R/R_community_course/freshwater_data_analysis/&quot;) #Load the package/library library(&quot;qiime2R&quot;) #Import data pseq &lt;- qiime2R::qza_to_phyloseq( features = &quot;table-dada2.qza&quot;, tree = &quot;rooted-tree.qza&quot;, taxonomy = &quot;taxonomy.sklearn.qza&quot;, metadata = &quot;media_metadata.txt&quot; ) This command creates a phyloseq object we name pseq. It contains: The ASV abundance table (features = \"table-dada2.qza\"). The rooted phylogenetic tree (tree = \"rooted-tree.qza\"). The taxonomic classifications of the ASVs (taxonomy = \"taxonomy.sklearn.qza\"). The sample metadata (metadata = \"media_metadata.txt\") 4.3 Save the phyloseq object When using multiple scripts for analysis it is useful to save the R objects that will be used in different script. This can be carried out with the function save(). save(pseq, file = &quot;phyloseq.RData&quot;) This saves our object pseq into the file phyloseq.RData. The suffix R.Data is the normal convention. Since our final object is saved we no longer need the objects in the environment. Therefore, you can use the sweep button in the Environment pane to remove them. 4.4 Recap We have imported our QIIME2 artifacts into one phyloseq object so we can analyse the data in R. This object has been saved into a \".RData\" file which we will load in the next chapter. "],["05-Preprocess_data.html", "Chapter 5 Preprocess", " Chapter 5 Preprocess "],["06-Taxonomy.html", "Chapter 6 Taxonomy", " Chapter 6 Taxonomy "],["07-Alpha.html", "Chapter 7 Alpha", " Chapter 7 Alpha "],["08-Beta.html", "Chapter 8 Beta", " Chapter 8 Beta "],["09-Differential_abundance_analysis.html", "Chapter 9 Differential abundance analysis", " Chapter 9 Differential abundance analysis "],["10-Appendix.html", "A Installing required packages B ggplot2", " A Installing required packages &lt;Note on opening RStudio as administrator.&gt; B ggplot2 Below are some useful resource if you would like to learn ggplot2. The R Graphics Cookbook is a good place to start. It contains a section called Understanding ggplot2 in its appendix which is useful for learning some key terminologies and concepts. ggplot2 requires its input to be in long format. You will therefore need to know how to convert your wide data to long data. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
