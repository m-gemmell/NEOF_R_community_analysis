[["01-R_community_supplemental.html", "R community analysis supplemental Chapter 1 Introduction", " R community analysis supplemental Matthew R. Gemmell 2023-08-31 Chapter 1 Introduction This book contains some supplemental materials for the R community workshop. The contents include: Importing other types of data in a phyloseq object. Using plotly to convert ggplot2 plots into interactive HTML based plots. This work is licensed under a Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License. "],["02-Importing.html", "Chapter 2 Importing 2.1 Bracken 2.2 Plain text files", " Chapter 2 Importing Apart from QIIME2 artifact files, other file types from other programs cann be imported into a phyloseq object. 2.1 Bracken A common way to carry out shotgun metagenomics taxonomic abundance profiling is with Kraken2 and Bracken. This section will show you how to import the bracken output. 2.1.1 Bracken: setup First we need the Bracken output in the Kraken2 report output file format. We can copy over the output made during the NEOF Shotgun metagenomics workshop. Note: If you are using Bracken ensure you are using the latest version as older versions do not provide this output. mkdir bracken_r_comm cd bracken_r_comm cp /pub14/tea/nsc206/NEOF/R_community/bracken_reports/*breport2 . We can also copy over the metadata file which we will use later. cp /pub14/tea/nsc206/NEOF/R_community/bracken_reports/KW_metadata.tsv . 2.1.2 Bracken: Convert to biom Unfortunately we can't use the bracken report files. Instead we need to convert them to one collated biom file with kraken-biom. kraken-biom *breport2 -o KW.biom Biom files are not human readable. Therefore to check the file is correct we can create a tsv (tab seperated value) file to inspect. #Create tsv file biom convert -i KW.biom -o KW.tsv --header-key taxonomy--to-tsv #inspect tsv file less KW.tsv If your file has a header starting with \"#OTU ID\" and the sample names, followed by rows of OTUs with abundance numbers it should be good. You'll also have the taxonomy lineage as the last column because we added in --header-key taxonomy. 2.1.3 Jupyter notebook Now we are ready to carry out some R analysis. Open up jupyter-notebook and create a new R notebook called \"Bracken_phyloseq_creation\". At the top of the notebook create a cell to load the libaries we'll need. #Libraries library(&quot;phyloseq&quot;) library(&quot;microbiome&quot;) library(&quot;insect&quot;) Import biom into phyloseq The first step is to import the biom file. #Read in bracken biom file pseq &lt;- phyloseq::import_biom(&quot;/KW.biom&quot;) Import sample data Next we need to import the samples data. We have a tab delimited file we will read into R as a data frame. The we can assign the sample data of pseq to the data frame. As long as the row names contain the same sample names as in the biom file it should work correctly. #Read in metadata metadf &lt;- read.csv(&quot;KW_metadata.tsv&quot;, sep=&quot;\\t&quot;, check.names = FALSE, row.names=1) #Check metadf head(metadf) #Assign sample data phyloseq::sample_data(pseq &lt;- metadf) We can then summarise our phyloseq object to make sure it seems ok. #Summarize microbiome::summarize_phyloseq(pseq) Taxonomy Let's check out the taxonomy #Check taxonomy head(phyloseq::tax_table(pseq)) It looks good but we'll carry out 2 tasks. First we'll change the taxonomy headers from Rank1... to Kingdom.... We know we can do this sue to the prefix of the taxonomies (\"k__\", \"p__\"...) #Change tax column names colnames(phyloseq::tax_table(pseq)) &lt;- c(&quot;Kingdom&quot;, &quot;Phylum&quot;, &quot;Class&quot;, &quot;Order&quot;, &quot;Family&quot;, &quot;Genus&quot;, &quot;Species&quot;) head(phyloseq::tax_table(pseq)) This next step is optional. We are going to aggregate the phyloseq object from taxids to genus. Shotgun metagenomics is not always the best tool at differentiating between species so genus classifications will be more reliable. #Aggregate to species genus_pseq &lt;- microbiome::aggregate_taxa(pseq, &quot;Genus&quot;, verbose = FALSE) #Summarise microbiome::summarize_phyloseq(genus_pseq) #Check number of genera paste0(&quot;Genera: &quot;, nrwo(phyloseq::otu_table(genus_pseq))) In your own analysis you may even want to use family or order to aggregate to, or to keep using species. Know your data, look at the literature, and make an informed decision. Of course it can be useful to look at multiple levels of taxonomy. 2.2 Plain text files If you have plain text files you can read them into R and then phyloseq-ize them. The phyloseq website has a nice tutorial on how to carry this out: https://joey711.github.io/phyloseq/import-data. "],["03-Plotly.html", "Chapter 3 R plotly", " Chapter 3 R plotly Plotly is a graphing library that allows you to create interactive charts and maps. These are in the form of html files. You can even embed these in online books like the below chart. Try hovering over points to get more information on them. library(&quot;ggplot2&quot;) library(&quot;plotly&quot;) library(palmerpenguins) data(package = &#39;palmerpenguins&#39;) scatter_plot &lt;- ggplot(data = penguins, aes(x = flipper_length_mm, y = body_mass_g)) + geom_point(aes(color = species, shape = species), size = 2) + scale_color_manual(values = c(&quot;darkorange&quot;,&quot;darkorchid&quot;,&quot;cyan4&quot;)) ggplotly(scatter_plot) "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
